@using System.Web.UI.WebControls
@model LMPlatform.UI.ViewModels.MessageViewModels.MessageViewModel

<div id="msgForm">
    @using (Html.BeginForm("WriteMessage", "Message", FormMethod.Post))
    {
        <div>
            @Html.ValidationSummary("Ошибка!", new { @class = "alert alert-error" })
        </div>

        <div>
            <hgroup style="text-align: center; margin-bottom: 20px">
                <h1>@ViewBag.Title</h1>
            </hgroup>
            @Html.HiddenFor(m => m.FromId)
               <div>
                @Html.LabelFor(m => m.Recipients, new { @class = "control-label" })
                @if (Model.ToAdmin)
                {
                    @Html.LabelFor(m => m.ToAdmin, new {style="font-size: 16px; display: block; text-align: center;"})
                    @Html.HiddenFor(m => m.ToAdmin)
                    @Html.HiddenFor(m => m.Recipients)
                }
                else
                {
                    @Html.ListBoxFor(m => m.Recipients, Enumerable.Empty<SelectListItem>(),
                                 new Dictionary<string, object> {
                                     { "data-placeholder", "Введите имя получателя..." },
                                     { "class", "form-control chosen-select" } })

                    @Html.ValidationMessageFor(m => m.Recipients, " ")
                }
                 <p></p>
            </div>
            <div>
                @Html.LabelFor(m => m.Subject)
                @Html.TextBoxFor(m => m.Subject, new { @class = "form-control" })
            </div>
            <div>
                @Html.LabelFor(m => m.MessageText)
                @Html.TextAreaFor(m => m.MessageText, new { @class = "form-control" })
                <p></p>
                <p></p>
            </div>
            <div style="width: 60%">
                @Html.Partial("Common/_FilesUploader", Model.Attachment)
            </div>
            <input type="submit" style="display: none" />
        </div>
    }
</div>

<script type="text/javascript">
    $('.modal-dialog').width('600px');
    @if (!Model.ToAdmin) {
        @: ajaxChosenInit(".chosen-select");
        }
</script>
