@using LMPlatform.Models
@model LMPlatform.UI.ViewModels.SubjectViewModels.SubjectWorkingViewModel
@{
    ViewBag.Title = Model.SubjectName;
    Layout = "../Shared/Layouts/_MainUsingNavLayout.cshtml";
}

@section scripts
{
    @Scripts.Render("~/bundles/datatable", "~/Scripts/ckeditor/ckeditor.js")
    @Scripts.Render("~/bundle/subjectWorking")
    @Scripts.Render("~/bundles/textAngular")
    <script src="~/Scripts/jqplot/jquery.jqplot.min.js" type="text/javascript"></script>
    <script src="~/Scripts/jqplot/jqplot.pieRenderer.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="~/Scripts/jqplot/jqplot.barRenderer.js"></script>
    <script type="text/javascript" src="~/Scripts/jqplot/jqplot.canvasAxisTickRenderer.js"></script>
    <script type="text/javascript" src="~/Scripts/jqplot/chart.js"></script>
}

<div ng-app="mainApp" ng-controller="MainCtrl" ng-init="init('@Model.SubjectId')">
    @section navleft
    {
        @foreach (var module in Model.Modules.Where(e => e.Type != ModuleType.Results && e.Type != ModuleType.StatisticsVisits && e.Type != ModuleType.ScheduleProtection).ToList())
        {
            if (module.Type == ModuleType.SmartTest)
            {
                <li class="navLink">
                <a class="moduleLinks linkNavbar" href="@Url.Action("Index", "Tests", new { subjectId = Model.SubjectId })">@module.Name</a>
            </li>    
            }
            else
            {
                <li class="navLink">
                    <a class="moduleLinks linkNavbar" href="#@module.Type">@module.Name</a>
                </li>
            }
        }
        <div>
            <img style="margin-left: 15%; margin-top: 10%; width: 200px" src="../../Images/schoolclass.png" />
        </div>

        @if (User.IsInRole("lector"))
        {
            <li><a id="subGroups" class="linkNavbar" href="@Url.Action("SubGroups", "Subject", new { subjectId = Model.SubjectId })"><i class="fa fa-users fa-2x fa-tab"></i>Управление подгруппами</a></li>
        }
        <li><a class="linkNavbar" href="@Url.Action("Subjects", "Subject")"><i class="fa fa-reply fa-1x fa-tab"></i>Сменить предмет</a></li>
        <li><a class="linkNavbar" href="@Url.Action("Index", "Lms")"><i class="fa fa-arrow-left fa-1x fa-tab"></i>Назад</a></li>

    }

    @section navpanel
    {
        @Model.SubjectName
    }
    <input type="hidden" ng-click="loadGroups()" id="loadGroups" />
    <div class="conteinerModule" data-subjectid="@Model.SubjectId"></div>
    <div ng-view></div>
</div>
<script type="text/javascript" src="~/Scripts/application/mainApp.js"></script>
<script>
    $(document).ready(function () {
        $('li.navLink').first().click();
        $('a.moduleLinks').first().click();
    });
</script>
