@using Application.Core.UI.HtmlHelpers
@using LMPlatform.UI.Controllers

@{
    ViewBag.Title = "Сообщения";
}
@section css
{
    <link rel="stylesheet" href="/Content/chosen/chosen.css">
}
@section scripts
{
    @Scripts.Render("~/bundles/datatable")
    <script src="/Scripts/chosen/chosen.jquery.js" type="text/javascript"></script>
    <script src="/Scripts/chosen/ajax-chosen.js" type="text/javascript"></script>

    <script src="/Scripts/angular.js" type="text/javascript"></script>
    <script src="/Scripts/ng-table.js" type="text/javascript"></script>
    <script src="/Scripts/application/msgModule.js" type="text/javascript"></script>
}

<style type="text/css">
    .nav a {
        cursor: pointer;
    }
</style>

<div ng-app="msgApp">
    <div class="page-header">
        <h2>Сообщения</h2>
    </div>
    <div>
        <div id="buttonActionSection">
            <a href="#" class="msg-send msgButton btn btn-primary btn-sm" data-url="@Url.Action("WriteMessage", "Message")" data-toggle="tooltip">Написать</a>
        </div>
    </div>
    <div class="row" ng-controller="msgController" ng-init="init(@WebSecurity.CurrentUserId)">
        <div class="col-md-12 tabbable tabs-left">
            <ul class="nav nav-tabs">
                <li ng-class="{'active': activeTab === 'inbox'}">
                    <a ng-click="switchTabTo('inbox')">Входящие</a>
                </li>
                <li ng-class="{'active': activeTab === 'outbox'}">
                    <a ng-click="switchTabTo('outbox')">Отправленные</a>
                </li>
            </ul>
            <div class="tab-content">
                <table>
                    <thead>
                        <th>Автор
                        </th>
                        <th>Тема
                        </th>
                    </thead>
                    <tbody>

                        <tr ng-repeat="msg in messages">
                            <td>{{msg.AuthorName}}</td>
                            <td>{{msg.Subject}}</td>
                            <td style="width: 78px;"></td>
                        </tr>
                    </tbody>
                </table>
                @*<div class="tab-pane message-tab active" id="inbox">*@
                @* <div>@Html.Partial("_MessageDataTable", new DataTableViewModel
             {
                 DataTable = Html.DataTable("incomingMessageList", (MessageController controller) => controller.GetCollectionMessages(null), new { isIncoming = true }),
                 DataTableOptions = new DataTableOptions
                     {
                         Pagination = false,
                         Searchable = true,
                         Sortable = false,
                         Filterable = false,
                         Info = false,
                         OnComplete = "initDisplayMessageDialog"
                     }
             })
                </div>*@
                @*</div>*@
                @*<div class="tab-pane message-tab" id="sent">*@
                @*     <div>@Html.Partial("_MessageDataTable", new DataTableViewModel
             {
                 DataTable = Html.DataTable("outcomingMessageList", (MessageController controller) => controller.GetCollectionMessages(null), new { isIncoming = false }),
                 DataTableOptions = new DataTableOptions
                     {
                         Pagination = true,
                         Searchable = true,
                         Sortable = false,
                         Filterable = false,
                         Info = false,
                         OnComplete = "initDisplayMessageDialog"
                     }
             })
                </div> *@
                @*</div>*@
            </div>
        </div>
    </div>
</div>
